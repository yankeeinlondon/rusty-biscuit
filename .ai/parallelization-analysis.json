[
  {
    "id": 1,
    "type": "PHASE_SPLIT",
    "title": "Split Phase 2 into Two Parallel Tasks",
    "description": "Phase 2 (Migrate TTS Module) has no internal dependencies but is currently blocking all downstream work. Split into Phase 2a and 2b to enable partial parallelization.",
    "details": {
      "phase_2a": {
        "name": "Move tts.rs and Create Stubs",
        "effort": "Low",
        "duration_estimate_minutes": 5,
        "tasks": [
          "Copy biscuit/src/tts.rs to biscuit-speaks/src/lib.rs",
          "Create empty stub at biscuit/src/tts.rs that re-exports from biscuit-speaks",
          "Update biscuit-speaks/Cargo.toml with tts dependency: tts = \"0.26.3\"",
          "Add required tts dependencies: thiserror, tracing"
        ],
        "enables_parallel_with": ["Phase 3", "Phase 4", "Phase 5"]
      },
      "phase_2b": {
        "name": "Update biscuit Exports",
        "effort": "Minimal",
        "duration_estimate_minutes": 2,
        "tasks": [
          "Update biscuit/src/lib.rs to remove tts module declaration",
          "Delete biscuit/src/tts.rs stub"
        ],
        "depends_on": ["Phase 2a", "Phase 3", "Phase 4", "Phase 5"]
      }
    },
    "benefit": "Consumers can import from biscuit-speaks immediately after Phase 2a, reducing critical path by up to 10 minutes",
    "risk_level": "LOW",
    "race_condition_risk": "NONE - stub provides compatibility during transition"
  },
  {
    "id": 2,
    "type": "PHASE_REORDERING",
    "title": "Reorder Phase 6 (Cleanup) Before Consumer Updates",
    "description": "Current plan blocks Phase 6 until all consumers are updated. This creates unnecessary serialization. Reorder to do cleanup first, then update consumers.",
    "details": {
      "reason": "The stub-based approach in Phase 2a means biscuit/src/tts.rs still exists with working re-export. Cleanup (Phase 6) can happen anytime after Phase 2a without breaking Phase 3-5.",
      "new_order": [
        "Phase 1: Set Up biscuit-speaks",
        "Phase 2a: Move TTS Module with stub",
        "Phase 6: Remove TTS from biscuit (cleanup and delete stub) - PARALLEL with Phase 3/4/5",
        "Phase 3/4/5: Update consumers (can run in parallel)"
      ]
    },
    "benefit": "Reduces critical path length by ~3-5 minutes; consumers still work via biscuit re-export during Phase 6",
    "risk_level": "MEDIUM",
    "race_condition_risk": "LOW - No actual conflicts; imports remain valid throughout",
    "considerations": [
      "Requires careful testing of stub-to-deletion transition",
      "All consumer updates (3/4/5) must still complete before Phase 8 (Final Validation)"
    ]
  },
  {
    "id": 3,
    "type": "CONCURRENT_CONSUMER_UPDATES",
    "title": "Enable Full Parallelization of Consumer Updates (Phase 3/4/5)",
    "description": "Current plan correctly identifies phases 3-5 as independent and parallelizable. Enhance by running them truly in parallel without serialization.",
    "details": {
      "current_state": "Plans suggest parallelizable but don't show parallel execution strategy",
      "recommended_execution": {
        "approach": "Use workspace build system to execute all three in parallel",
        "command": "cargo build -p so-you-say -p research-cli -p research-lib",
        "duration_estimate_minutes": 2,
        "individual_phases": [
          {
            "phase": 3,
            "task": "Update so-you-say/Cargo.toml + src/main.rs imports",
            "files": 2,
            "changes": "Import change (1 line)"
          },
          {
            "phase": 4,
            "task": "Update research/cli/src/main.rs imports",
            "files": 1,
            "changes": "Two import changes (lines 265, 348)"
          },
          {
            "phase": 5,
            "task": "Update research/lib/src/main.rs imports",
            "files": 1,
            "changes": "One import change (line 24)"
          }
        ]
      },
      "validation_command": "cargo test --workspace && cargo clippy --workspace -- -D warnings"
    },
    "benefit": "Reduces phase 3/4/5 duration from 6 minutes (sequential) to 2 minutes (parallel)",
    "risk_level": "VERY_LOW",
    "race_condition_risk": "NONE - No shared files or state modified"
  },
  {
    "id": 4,
    "type": "DEPENDENCY_ANALYSIS",
    "title": "Verify No Cyclic Workspace Dependencies",
    "description": "Ensure biscuit-speaks introduction doesn't create circular dependency patterns that could block parallel builds.",
    "details": {
      "current_dependency_graph": {
        "so-you-say": ["shared/biscuit"],
        "research-cli": ["shared/biscuit"],
        "research-lib": ["shared/biscuit"]
      },
      "post_migration_graph": {
        "so-you-say": ["biscuit-speaks"],
        "research-cli": ["biscuit-speaks"],
        "research-lib": ["biscuit-speaks"],
        "biscuit-speaks": []
      },
      "analysis": "NO CYCLES DETECTED. biscuit-speaks should have minimal dependencies (only: tts crate, thiserror, tracing).",
      "recommendation": "Keep biscuit-speaks as a leaf dependency with no reverse dependencies from biscuit or other packages."
    },
    "benefit": "Enables cargo to fully parallelize compilation of consumer packages",
    "risk_level": "LOW",
    "race_condition_risk": "NONE if guidelines followed"
  },
  {
    "id": 5,
    "type": "DOCUMENTATION_PARALLELIZATION",
    "title": "Parallelize Documentation Updates with Phase 6",
    "description": "Phase 7 (Update Documentation) currently depends on Phase 6. Both can run in parallel since they modify different files.",
    "details": {
      "current": "Phase 6 → Phase 7 (serialized)",
      "proposed": "Phase 6 ∥ Phase 7 (parallel)",
      "files_modified": {
        "phase_6": ["biscuit/src/tts.rs (deleted)", "biscuit/src/lib.rs"],
        "phase_7": ["tree-hugger/README.md", "biscuit-speaks/README.md", "CLAUDE.md", "other docs"]
      },
      "no_conflicts": true,
      "parallel_execution": "Run both phases independently; both feed into Phase 8"
    },
    "benefit": "Reduces final 2-phase duration from 5 minutes to 3 minutes",
    "risk_level": "VERY_LOW",
    "race_condition_risk": "NONE - Different files modified"
  },
  {
    "id": 6,
    "type": "STUB_STRATEGY",
    "title": "Implement Gradient Cutover with Re-export Stub",
    "description": "Use a temporary re-export stub in biscuit to maintain API compatibility during migration, allowing true parallel consumer updates.",
    "details": {
      "implementation": {
        "file": "biscuit/src/tts.rs",
        "content": "pub use biscuit_speaks::*;",
        "duration_to_add": "Immediate (1 line)",
        "duration_to_remove": "2 minutes (Phase 2b or Phase 6)"
      },
      "benefits": [
        "Consumers can be updated in any order without breaking intermediate builds",
        "Allows Phase 2a to complete quickly while stubs handle compatibility",
        "Enables true parallel execution of Phase 3/4/5 without orchestration"
      ],
      "timeline_comparison": {
        "without_stub": "Sequential phases required: Phase 2 → Phase 3 → Phase 4 → Phase 5 (12 min)",
        "with_stub": "Parallel phases possible: Phase 2a, then Phase 3/4/5 in parallel (8 min total)"
      }
    },
    "risk_level": "LOW",
    "race_condition_risk": "NONE - Stub is a simple re-export with no state"
  },
  {
    "id": 7,
    "type": "TESTING_STRATEGY",
    "title": "Parallel Testing During Phase 8",
    "description": "Phase 8 runs tests and clippy sequentially. These can be parallelized with proper isolation.",
    "details": {
      "current": [
        "cargo test --workspace",
        "cargo clippy --workspace -- -D warnings"
      ],
      "issues": {
        "test_isolation": "TTS-related tests need the new biscuit-speaks module to exist",
        "clippy_dependencies": "Clippy checks don't depend on test results"
      },
      "recommendation": {
        "phase_8a": "Run cargo build --workspace (prerequisite)",
        "phase_8b": "Run in parallel: cargo test --workspace && cargo clippy --workspace (both read compiled artifacts)"
      },
      "execution": "cargo test --workspace & cargo clippy --workspace & -- -D warnings",
      "duration": "6-8 minutes (parallel) vs 12-15 minutes (sequential)"
    },
    "benefit": "Reduces Phase 8 duration by ~50%",
    "risk_level": "LOW",
    "race_condition_risk": "NONE - Different compilation profiles (test vs check)"
  },
  {
    "id": 8,
    "type": "CRITICAL_PATH_OPTIMIZATION",
    "title": "Optimized Execution Plan",
    "description": "Recommended schedule to minimize total execution time while maintaining safety.",
    "details": {
      "optimized_plan": [
        {
          "phase": "1",
          "name": "Set Up biscuit-speaks Package",
          "duration_minutes": 3,
          "command": "cargo generate --path biscuit-speaks && edit Cargo.toml"
        },
        {
          "phase": "2a",
          "name": "Migrate TTS Module with Stub",
          "duration_minutes": 5,
          "parallel_with": "None (foundational)",
          "command": "cp biscuit/src/tts.rs biscuit-speaks/src/lib.rs && update biscuit-speaks/Cargo.toml"
        },
        {
          "phase": "2b+3+4+5",
          "name": "Update Consumers + Cleanup in Parallel",
          "duration_minutes": 8,
          "parallel_tasks": [
            "2b: Delete biscuit stub (2 min)",
            "3: Update so-you-say (2 min)",
            "4: Update research/cli (2 min)",
            "5: Update research/lib (2 min)"
          ],
          "command": "Run all 4 in parallel"
        },
        {
          "phase": "6+7",
          "name": "Cleanup + Documentation in Parallel",
          "duration_minutes": 3,
          "parallel_tasks": [
            "6: Delete tts.rs (1 min)",
            "7: Update documentation (2 min)"
          ]
        },
        {
          "phase": "8",
          "name": "Final Validation (Tests + Clippy Parallel)",
          "duration_minutes": 8,
          "command": "cargo test --workspace & cargo clippy --workspace & wait"
        }
      ],
      "total_optimized_time": "27 minutes",
      "original_sequential_time": "45 minutes",
      "improvement": "40% reduction in total execution time"
    },
    "risk_level": "LOW",
    "race_condition_risk": "VERY_LOW with proper ordering"
  }
]
