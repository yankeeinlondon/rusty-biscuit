# Rename mat CLI to md CLI

**Created:** 2026-01-03
**Status:** Draft - Awaiting Review

## Executive Summary

Rename the `mat` CLI (markdown renderer) to `md` by moving the directory from `/mat` to `/md` and updating all references in Cargo configuration, justfiles, and documentation. This is a straightforward rename operation with documentation synchronization.

## Requirements

### Functional Requirements

| ID | Requirement | Priority | Owner |
|----|-------------|----------|-------|
| FR-1 | Move `/mat` directory to `/md` | High | Rust Developer |
| FR-2 | Update package name in Cargo.toml files | High | Rust Developer |
| FR-3 | Update binary name to `md` | High | Rust Developer |
| FR-4 | Update workspace members in root Cargo.toml | High | Rust Developer |
| FR-5 | Update justfile references (root and area) | High | Rust Developer |
| FR-6 | Update all documentation referencing `mat` | High | Rust Developer |

### Non-Functional Requirements

| ID | Requirement | Target | Owner |
|----|-------------|--------|-------|
| NFR-1 | Build succeeds after rename | `cargo build -p md` passes | Rust Developer |
| NFR-2 | Tests pass after rename | `cargo test -p md` passes | Feature Tester |
| NFR-3 | Documentation accuracy | All docs reference `md` not `mat` | Rust Developer |

## Architecture Overview

This is a rename operation, not an architectural change. The CLI structure remains identical:

```
Before:                          After:
dockhand/                        dockhand/
├── mat/                         ├── md/
│   ├── Cargo.toml              │   ├── Cargo.toml
│   ├── README.md               │   ├── README.md
│   ├── justfile                │   ├── justfile
│   ├── src/                    │   ├── src/
│   └── tests/                  │   └── tests/
```

## Phases

### Phase 1: Directory and Cargo Rename

**Principal Owner:** Rust Developer

**Goal:** Move directory and update all Cargo configuration

**Dependencies:** None

**Blast Radius:** `cargo build --workspace` (full workspace build to verify no breaks)

**Deliverables:**
- `/mat` directory renamed to `/md`
- `md/Cargo.toml` updated with `name = "md"` and `[[bin]] name = "md"`
- Root `Cargo.toml` workspace members updated from `"mat"` to `"md"`

**Files to modify:**
- Move: `/mat` → `/md`
- Edit: `/md/Cargo.toml` (lines 2, 7: change `mat` → `md`)
- Edit: `/Cargo.toml` (line 3: change `"mat"` → `"md"` in members array)

**Technical Details:**
```bash
# Directory rename
git mv mat md

# Cargo.toml changes
# /md/Cargo.toml:
#   name = "md"         (was "mat")
#   [[bin]] name = "md" (was "mat")

# /Cargo.toml:
#   members = ["md", ...]  (was "mat")
```

**Acceptance Criteria:**
- [ ] Directory `/Volumes/coding/personal/dockhand/md` exists
- [ ] Directory `/Volumes/coding/personal/dockhand/mat` does NOT exist
- [ ] `grep 'name = "md"' md/Cargo.toml` succeeds (package name)
- [ ] `grep '\[\[bin\]\]' -A1 md/Cargo.toml | grep 'name = "md"'` succeeds
- [ ] `grep '"md"' Cargo.toml | grep members` succeeds
- [ ] `grep '"mat"' Cargo.toml` finds NO matches
- [ ] `cargo build -p md` succeeds
- [ ] `cargo build --workspace` succeeds

---

### Phase 2: Justfile Updates

**Principal Owner:** Rust Developer

**Goal:** Update all justfile references from `mat` to `md`

**Dependencies:** Phase 1 complete

**Blast Radius:** `just build` and `just test` (verify monorepo commands work)

**Deliverables:**
- Root `justfile` areas variable updated
- Root `justfile` md target updated to use `/md` directory
- Area `md/justfile` updated with correct package references

**Files to modify:**
- Edit: `/justfile` (line 5: change `mat` → `md` in areas list; line 88: change `cd mat` → `cd md`)
- Edit: `/md/justfile` (multiple lines: change `mat` → `md`)

**Technical Details:**

Root justfile changes:
```just
# Line 5
areas := "shared research so-you-say md sniff"  # was "mat"

# Line 88
cd md 2>/dev/null  # was "cd mat"
```

Area justfile changes (`/md/justfile`):
```just
# Line 19
@echo "md CLI"  # was "mat CLI"

# Line 28
@echo "Build md CLI"  # was "mat"

# Line 31
@cargo build -p md {{args}}  # was "mat"

# Line 36
@echo "Testing md CLI"  # was "mat"

# Line 39
@cargo test -p md {{args}}  # was "mat"

# Line 44
@echo "Linting md CLI"  # was "mat"

# Line 50
@cargo build --release -p md  # was "mat"

# Line 55
@cargo run -p md -- {{args}}  # was "mat"
```

**Acceptance Criteria:**
- [ ] `grep 'areas.*md' justfile` succeeds
- [ ] `grep -v mat justfile` shows no `mat` references (except comments if any)
- [ ] `grep 'cd md' justfile` succeeds
- [ ] `grep 'mat' md/justfile` finds NO matches
- [ ] `just build` succeeds
- [ ] `just test` succeeds
- [ ] `just -f md/justfile build` succeeds
- [ ] `just -f md/justfile test` succeeds

---

### Phase 3: Documentation Updates

**Principal Owner:** Rust Developer

**Goal:** Update all documentation to reference `md` instead of `mat`

**Dependencies:** Phase 1 and 2 complete (so we can reference correct paths)

**Blast Radius:** Documentation only - no code tests needed, but verify files exist

**Deliverables:**
- `/md/README.md` updated
- `/CLAUDE.md` updated to include `md` in monorepo structure and commands
- Any `.ai/plans/*.md` files that reference `mat` updated

**Files to modify:**
- Edit: `/md/README.md` - Change all `mat` references to `md`
- Edit: `/CLAUDE.md` - Add `md/` to monorepo structure and update commands section

**Technical Details:**

`/md/README.md` changes (full rewrite):
```markdown
# `md` CLI

A CLI markdown renderer for the terminal.

## Syntax

> **md \<file\>** [_options_]

The `md` command will render a markdown file with rich color themes.
...
```

`/CLAUDE.md` additions:
- Add `md/` line to monorepo structure (after `mat/` removal or replacement)
- Add build/test/install commands for `md` CLI
- Add `just md` command documentation

**Files containing `mat` references to check:**
1. `/mat/README.md` → `/md/README.md` (rename happens in Phase 1, content update here)
2. `/CLAUDE.md` - Does NOT currently mention `mat`, but should mention `md`
3. `.ai/plans/*.md` - Historical plans, may keep as-is for historical accuracy

**Acceptance Criteria:**
- [ ] `grep -r 'mat' md/README.md` finds NO matches (except in table cell alignments like `|---|`)
- [ ] `grep 'md/' CLAUDE.md` succeeds (monorepo structure)
- [ ] File `/md/README.md` exists with >20 lines
- [ ] `md` CLI is documented in CLAUDE.md monorepo structure section

---

### Phase 4: Historical Plan Files (Optional Cleanup)

**Principal Owner:** Rust Developer

**Goal:** Decide whether to update historical `.ai/plans/*.md` files

**Dependencies:** Phases 1-3 complete

**Blast Radius:** None - documentation only

**Deliverables:**
- Decision on whether to update historical files
- If updating: all `.ai/plans/*.md` files referencing `mat` updated

**Files that reference `mat`:**
- `.ai/plans/2026-01-01.image-render-in-terminal.md`
- `.ai/plans/2026-01-01.mat-verbose-flag.md`
- `.ai/plans/2026-01-01.mat-cli-refactor.md`
- `.ai/features/archived/2026-01-01. mat-refactor.md/feature.md`
- `shared/.ai/plans/2025-12-31.markdown-struct.md`
- `shared/.ai/features/2025-12-31. markdown-struct/feature.md`

**Recommendation:** Keep historical files as-is. They represent the state at the time of writing. The rename is documented in this plan file.

**Acceptance Criteria:**
- [ ] Decision documented (update or preserve history)
- [ ] If updating: `grep -r '\bmat\b' .ai/` finds no unexpected matches

---

## Cross-Cutting Concerns

### Testing Strategy
- Phase 1: `cargo build --workspace` to verify Cargo config
- Phase 2: `just build` and `just test` to verify justfiles
- Phase 3: Manual review of documentation accuracy
- Phase 4: N/A (documentation decision)

### Git Considerations
- Use `git mv mat md` to preserve git history
- Single commit for all changes to maintain atomic rename
- Commit message: `refactor(cli): rename mat CLI to md`

### Cargo.lock
- The `Cargo.lock` will automatically update when building after the rename
- No manual edits needed

## Parallelization Opportunities

| Parallel Group | Phases | Reason |
|----------------|--------|--------|
| Group A | Phase 1 | Must complete first (directory rename) |
| Group B | Phase 2, Phase 3 | Can run in parallel after Phase 1 |
| Group C | Phase 4 | Optional, after all others |

```
Timeline:
───────────────────────────────────────────►

Phase 1: ████████ (Directory + Cargo rename)
              │
              ├── Phase 2: ████████ (Justfile updates)
              │
              └── Phase 3: ████████ (Documentation updates)
                                  │
Phase 4 (optional):               └── ████ (Historical cleanup)
```

## Risk Assessment

| Risk | Impact | Mitigation |
|------|--------|------------|
| Cargo.lock conflicts | Low | Regenerate with `cargo build` |
| Missed documentation references | Low | Use `grep -r mat` to find all |
| Git history loss | Medium | Use `git mv` instead of manual move |

## Open Questions

- [ ] Should historical `.ai/plans/*.md` files be updated or preserved?
  - **Recommendation:** Preserve as historical record

## Verification Commands

After all phases complete, run these commands to verify success:

```bash
# Verify directory structure
ls -la md/
test ! -d mat && echo "mat directory removed: OK"

# Verify Cargo configuration
cargo build -p md
cargo test -p md

# Verify justfile configuration
just build
just test
just -f md/justfile build

# Verify no stray mat references in active config
grep -r '\bmat\b' Cargo.toml justfile md/
# Expected: No output (or only in comments/historical context)

# Verify md CLI runs
cargo run -p md -- --help
```
